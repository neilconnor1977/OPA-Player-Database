<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>One Premier Academy - Players</title>
  
  <!-- Import Jost font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Jost:wght@300;400;500;600;700&display=swap">
  
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <!-- Custom styles -->
  <link rel="stylesheet" href="css/players.css">
<script src="https://sites.super.myninja.ai/_assets/ninja-daytona-script.js"></script>
</head>
<body>
  <!-- Sidebar -->
  <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse">
    <div class="sidebar-sticky">
      <div class="text-center mb-4">
        <h4 class="text-white">Player Database</h4>
      </div>
      <ul class="nav flex-column">
        <li class="nav-item">
          <a class="nav-link" href="/dashboard">
            <i class="fas fa-home me-2"></i>
            Dashboard
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="/players">
            <i class="fas fa-users me-2"></i>
            Players
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/statistics">
            <i class="fas fa-chart-line me-2"></i>
            Statistics
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/meetings">
            <i class="fas fa-calendar me-2"></i>
            IDP Meetings
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="/files">
            <i class="fas fa-file me-2"></i>
            Files & Photos
          </a>
        </li>
        <li class="nav-item mt-5">
          <a class="nav-link" href="#" id="logout-link">
            <i class="fas fa-sign-out-alt me-2"></i>
            Logout
          </a>
        </li>
      </ul>
    </div>
  </nav>
  
  <!-- Main content -->
  <main class="main-content">
    <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
      <h1 class="h2">Players</h1>
      <div class="btn-toolbar mb-2 mb-md-0">
        <a href="/players/new" class="btn btn-primary">
          <i class="fas fa-plus me-2"></i> Add New Player
        </a>
      </div>
    </div>
    
    <!-- Filter section -->
    <div class="card mb-4">
      <div class="card-body">
        <div class="row g-3">
          <div class="col-md-4">
            <div class="input-group">
              <input type="text" class="form-control" id="search-input" placeholder="Search players...">
              <button class="btn btn-outline-secondary" type="button" id="search-button">
                <i class="fas fa-search"></i>
              </button>
            </div>
          </div>
          <div class="col-md-3">
            <select class="form-select" id="team-filter">
              <option value="">All Teams</option>
              <optgroup label="Boys Teams">
                <option value="B 11 & 12">B 11 & 12</option>
                <option value="B 12 & 13">B 12 & 13</option>
                <option value="B 13 & 14">B 13 & 14</option>
                <option value="B 14 & 15">B 14 & 15</option>
                <option value="B 15 & 16">B 15 & 16</option>
                <option value="B 16 & 17">B 16 & 17</option>
                <option value="B 17 & 18">B 17 & 18</option>
              </optgroup>
              <optgroup label="Girls Teams">
                <option value="G 10 & 11">G 10 & 11</option>
                <option value="G 11 & 12">G 11 & 12</option>
                <option value="G 12 & 13">G 12 & 13</option>
              </optgroup>
            </select>
          </div>
          <div class="col-md-3">
            <select class="form-select" id="type-filter">
              <option value="">All Types</option>
              <option value="FT">Full Time (FT)</option>
              <option value="PT">Part Time (PT)</option>
              <option value="T">Trial (T)</option>
              <option value="S">Scholar (S)</option>
            </select>
          </div>
          <div class="col-md-2">
            <button class="btn btn-secondary w-100" id="reset-filters">
              <i class="fas fa-sync-alt me-2"></i> Reset
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Player stats cards -->
    <div class="row mb-4">
      <div class="col-md-3">
        <div class="card bg-light">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-muted mb-0">Total Players</h6>
                <h3 class="mb-0" id="total-players-count">0</h3>
              </div>
              <div class="bg-primary rounded-circle p-3">
                <i class="fas fa-users text-white"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card bg-light">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-muted mb-0">Full Time</h6>
                <h3 class="mb-0" id="ft-players-count">0</h3>
              </div>
              <div class="bg-success rounded-circle p-3">
                <i class="fas fa-user-check text-white"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card bg-light">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-muted mb-0">Part Time</h6>
                <h3 class="mb-0" id="pt-players-count">0</h3>
              </div>
              <div class="bg-warning rounded-circle p-3">
                <i class="fas fa-user-clock text-white"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card bg-light">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
              <div>
                <h6 class="text-muted mb-0">Scholar</h6>
                <h3 class="mb-0" id="s-players-count">0</h3>
              </div>
              <div class="bg-info rounded-circle p-3">
                <i class="fas fa-user-graduate text-white"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Players table -->
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <span>Player List</span>
        <div class="btn-group">
          <button class="btn btn-sm btn-outline-secondary" id="export-csv">
            <i class="fas fa-file-csv me-1"></i> Export CSV
          </button>
          <button class="btn btn-sm btn-outline-secondary" id="print-list">
            <i class="fas fa-print me-1"></i> Print
          </button>
        </div>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-striped table-hover">
            <thead>
              <tr>
                <th>Player Name</th>
                <th>Parent Name</th>
                <th>Email</th>
                <th>Team</th>
                <th>Type</th>
                <th>League</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="players-table-body">
              <!-- Player data will be loaded here -->
              <tr>
                <td colspan="7" class="text-center">
                  <div class="spinner-container">
                    <div class="spinner-border text-primary" role="status">
                      <span class="visually-hidden">Loading...</span>
                    </div>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <!-- Pagination -->
        <div class="d-flex justify-content-between align-items-center mt-3">
          <div>
            <span id="showing-entries">Showing 0 to 0 of 0 entries</span>
          </div>
          <nav aria-label="Page navigation">
            <ul class="pagination" id="pagination">
              <!-- Pagination will be generated here -->
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </main>
  
  <!-- View Player Modal -->
  <div class="modal fade" id="viewPlayerModal" tabindex="-1" aria-labelledby="viewPlayerModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="viewPlayerModalLabel">Player Details</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="player-details-content">
          <!-- Player details will be loaded here -->
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="edit-player-btn">Edit Player</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Delete Confirmation Modal -->
  <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete this player? This action cannot be undone.
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-danger" id="confirm-delete-btn">Delete</button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
  
  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
  
  
</head>
        <body>
          <h1>One Premier Academy - Player List</h1>
          <table>
            <thead>
              <tr>
                <th>Player Name</th>
                <th>Parent Name</th>
                <th>Email</th>
                <th>Team</th>
                <th>Type</th>
                <th>League</th>
              </tr>
            </thead>
            <tbody>
      `;
      
      // Add rows for each player
      filteredPlayers.forEach(player => {
        printContent += `
          <tr>
            <td>${player.playerName || ''}</td>
            <td>${player.parentName || ''}</td>
            <td>${player.email || ''}</td>
            <td>${player.team || ''}</td>
            <td>${player.type || ''}</td>
            <td>${player.league || ''}</td>
          </tr>
        `;
      });
      
      // Close the table and HTML
      printContent += `
            </tbody>
          </table>
          <div class="footer">
            Generated on ${new Date().toLocaleDateString()} | One Premier Academy
          </div>
        
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    
    <!-- Firebase Configuration -->
    <script src="js/firebase-config.js"></script>
    
    <!-- Page Specific JavaScript -->
    <script src="js/players.js"></script>
    
</body>
        </html>
      `;
      
      // Open a new window and print
      const printWindow = window.open('', '_blank');
      printWindow.document.write(printContent);
      printWindow.document.close();
      printWindow.focus();
      
      // Print after a short delay to ensure content is loaded
      setTimeout(() => {
        printWindow.print();
        printWindow.close();
      }, 500);
    }
    
    // Set up event listeners
    document.addEventListener('DOMContentLoaded', function() {
      // Search button
      document.getElementById('search-button').addEventListener('click', applyFilters);
      
      // Search input (search on enter key)
      document.getElementById('search-input').addEventListener('keyup', function(event) {
        if (event.key === 'Enter') {
          applyFilters();
        }
      });
      
      // Team filter
      document.getElementById('team-filter').addEventListener('change', applyFilters);
      
      // Type filter
      document.getElementById('type-filter').addEventListener('change', applyFilters);
      
      // Reset filters button
      document.getElementById('reset-filters').addEventListener('click', function() {
        document.getElementById('search-input').value = '';
        document.getElementById('team-filter').value = '';
        document.getElementById('type-filter').value = '';
        
        filteredPlayers = [...allPlayers];
        currentPage = 1;
        displayPlayers();
      });
      
      // Export to CSV button
      document.getElementById('export-csv').addEventListener('click', exportToCsv);
      
      // Print list button
      document.getElementById('print-list').addEventListener('click', printPlayerList);
      
      // Confirm delete button
      document.getElementById('confirm-delete-btn').addEventListener('click', function() {
        const playerId = this.getAttribute('data-id');
        deletePlayer(playerId);
      });
      
      // Edit player button in view modal
      document.getElementById('edit-player-btn').addEventListener('click', function() {
        const playerId = this.getAttribute('data-id');
        window.location.href = `/players/edit?id=${playerId}`;
      });
    });
  </script>
</body>
</html>